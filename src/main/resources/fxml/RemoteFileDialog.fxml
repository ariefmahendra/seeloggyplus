<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.seeloggyplus.controller.RemoteFileDialogController"
            prefWidth="900" prefHeight="700" minWidth="850" minHeight="650">

    <!-- Top: Title -->
    <top>
        <VBox>
            <padding>
                <Insets top="15" right="15" bottom="15" left="15"/>
            </padding>
            <Label text="Open File"/>
            <Label text="Select a log file from local drive or remote server via SSH"
            />
        </VBox>
    </top>

    <!-- Center: TabPane with Local and Remote options -->
    <center>
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">
            <BorderPane.margin>
                <Insets top="10" right="10" bottom="10" left="10"/>
            </BorderPane.margin>

            <!-- Local File Tab -->
            <Tab fx:id="localTab" text="Local Drive">
                <VBox fx:id="localBrowserPane" spacing="15">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>

                    <VBox spacing="10">
                        <Label text="Select Local File"/>

                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <TextField fx:id="localFilePathField" promptText="No file selected"
                                       editable="false" HBox.hgrow="ALWAYS"/>
                            <Button fx:id="browseLocalButton" text="Browse..." prefWidth="100"/>
                        </HBox>

                        <Label text="Select a log file from your local drive"
                        />
                    </VBox>

                    <VBox spacing="8" VBox.vgrow="ALWAYS"
                          maxHeight="150">
                        <Label text="ðŸ’¡ Quick Tips"/>
                        <Label text="â€¢ Supported file types: .log, .txt, and all text files" wrapText="true"/>
                        <Label text="â€¢ Large files (>100MB) will be loaded with progress indicator" wrapText="true"/>
                        <Label text="â€¢ You can change parsing configuration after loading the file" wrapText="true"/>
                    </VBox>
                </VBox>
            </Tab>

            <!-- Remote SSH Tab -->
            <Tab fx:id="remoteTab" text="Remote (SSH)">
                <VBox spacing="15">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>

                    <!-- SSH Connection Settings -->
                    <VBox spacing="10">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="SSH Connection" HBox.hgrow="ALWAYS"/>
                            <Label fx:id="connectionStatusLabel" text="Not connected"/>
                        </HBox>

                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Saved Servers:" minWidth="120"/>
                            <ComboBox fx:id="savedServersComboBox" promptText="Select a saved server..."
                                      HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                            <Button fx:id="loadServerButton" text="Load" prefWidth="60"/>
                            <Button fx:id="saveServerButton" text="Save" prefWidth="60"/>
                            <Button fx:id="deleteServerButton" text="Delete" prefWidth="60"/>
                        </HBox>

                        <Separator/>

                        <GridPane hgap="10" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints minWidth="100" prefWidth="120"/>
                                <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                                <ColumnConstraints minWidth="80" prefWidth="100"/>
                                <ColumnConstraints hgrow="ALWAYS" minWidth="100" prefWidth="150"/>
                            </columnConstraints>

                            <!-- Row 0: Host and Port -->
                            <Label text="Host:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                            <TextField fx:id="hostField" promptText="192.168.1.100 or example.com"
                                       GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                            <Label text="Port:" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                            <TextField fx:id="portField" text="22" prefWidth="80"
                                       GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                            <!-- Row 1: Username -->
                            <Label text="Username:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                            <TextField fx:id="usernameField" promptText="Enter SSH username"
                                       GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="1"/>

                            <!-- Row 2: Authentication Method -->
                            <Label text="Authentication:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                            <CheckBox fx:id="usePrivateKeyCheckBox" text="Use Private Key"
                                      GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="2"/>

                            <!-- Row 3: Password -->
                            <Label text="Password:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                            <PasswordField fx:id="passwordField" promptText="Enter password"
                                           GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="3"/>

                            <!-- Row 4: Private Key Path -->
                            <Label text="Private Key:" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                            <TextField fx:id="privateKeyPathField" promptText="Path to private key file"
                                       GridPane.columnIndex="1" GridPane.columnSpan="2" GridPane.rowIndex="4"/>
                            <Button fx:id="browseKeyButton" text="Browse..."
                                    GridPane.columnIndex="3" GridPane.rowIndex="4"/>

                            <!-- Row 5: Passphrase -->
                            <Label text="Passphrase:" GridPane.columnIndex="0" GridPane.rowIndex="5"/>
                            <PasswordField fx:id="passphraseField" promptText="Key passphrase (if required)"
                                           GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="5"/>
                        </GridPane>

                        <HBox spacing="10" alignment="CENTER_RIGHT">
                            <CheckBox fx:id="savePasswordCheckBox" text="Save password"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button fx:id="connectButton" text="Connect" prefWidth="100"
                            />
                            <Button fx:id="disconnectButton" text="Disconnect" prefWidth="100"/>
                        </HBox>
                    </VBox>

                    <!-- Remote File Browser -->
                    <VBox fx:id="remoteBrowserPane" spacing="10" VBox.vgrow="ALWAYS"
                    >

                        <Label text="Remote File Browser"/>

                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Label text="Path:"/>
                            <TextField fx:id="remotePathField" promptText="/var/log" HBox.hgrow="ALWAYS"/>
                            <Button fx:id="goButton" text="Go" prefWidth="60"/>
                            <Button fx:id="parentDirButton" text="â†‘ Parent" prefWidth="80"/>
                        </HBox>

                        <TableView fx:id="remoteFilesTable" VBox.vgrow="ALWAYS" prefHeight="250" minHeight="200">
                            <columns>
                                <TableColumn fx:id="fileNameColumn" text="Name" prefWidth="400"/>
                                <TableColumn fx:id="fileTypeColumn" text="Type" prefWidth="120"/>
                                <TableColumn fx:id="fileSizeColumn" text="Size" prefWidth="150"/>
                            </columns>
                            <placeholder>
                                <Label text="Connect to SSH server to browse files"/>
                            </placeholder>
                        </TableView>

                        <Label text="Double-click on a directory to navigate, select a file and click OK to open"
                        />
                    </VBox>
                </VBox>
            </Tab>
        </TabPane>
    </center>

    <!-- Bottom: Action Buttons -->
    <bottom>
        <HBox spacing="10" alignment="CENTER_RIGHT"
        >
            <padding>
                <Insets top="10" right="15" bottom="10" left="15"/>
            </padding>

            <Button fx:id="okButton" text="OK" prefWidth="80" defaultButton="true"
            />
            <Button fx:id="cancelButton" text="Cancel" prefWidth="80" cancelButton="true"/>
        </HBox>
    </bottom>

</BorderPane>
