<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane minHeight="650" minWidth="850" prefHeight="700" prefWidth="900" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.seeloggyplus.controller.RemoteFileDialogController">

    <!-- Top: Title -->
    <top>
        <VBox>
            <padding>
                <Insets bottom="15" left="15" right="15" top="15" />
            </padding>
            <Label text="Open File" />
            <Label text="Select a log file from local drive or remote server via SSH" />
        </VBox>
    </top>

    <!-- Center: TabPane with Local and Remote options -->
    <center>
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">
            <BorderPane.margin>
                <Insets bottom="10" left="10" right="10" top="10" />
            </BorderPane.margin>

            <!-- Local File Tab -->
            <Tab fx:id="localTab" text="Local Drive">
                <VBox fx:id="localBrowserPane" spacing="15">
                    <padding>
                        <Insets bottom="15" left="15" right="15" top="15" />
                    </padding>

                    <VBox spacing="10">
                        <Label text="Select Local File" />

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <TextField fx:id="localFilePathField" editable="false" promptText="No file selected" HBox.hgrow="ALWAYS" />
                            <Button fx:id="browseLocalButton" prefWidth="100" text="Browse..." />
                        </HBox>

                        <Label text="Select a log file from your local drive" />
                    </VBox>

                    <VBox maxHeight="150" spacing="8" VBox.vgrow="ALWAYS">
                        <Label text="ðŸ’¡ Quick Tips" />
                        <Label text="â€¢ Supported file types: .log, .txt, and all text files" wrapText="true" />
                        <Label text="â€¢ Large files (&gt;100MB) will be loaded with progress indicator" wrapText="true" />
                        <Label text="â€¢ You can change parsing configuration after loading the file" wrapText="true" />
                    </VBox>
                </VBox>
            </Tab>

            <!-- Remote SSH Tab -->
            <Tab fx:id="remoteTab" text="Remote (SSH)">
                <VBox spacing="15">
                    <padding>
                        <Insets bottom="15" left="15" right="15" top="15" />
                    </padding>

                    <!-- SSH Connection Settings -->
                    <VBox spacing="10">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="SSH Connection" HBox.hgrow="ALWAYS" />
                            <Label fx:id="connectionStatusLabel" text="Not connected" />
                        </HBox>

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label minWidth="120" text="Saved Servers:" />
                            <ComboBox fx:id="savedServersComboBox" maxWidth="Infinity" promptText="Select a saved server..." HBox.hgrow="ALWAYS" />
                            <Button fx:id="loadServerButton" prefWidth="60" text="Load" />
                            <Button fx:id="saveServerButton" prefWidth="60" text="Save" />
                            <Button fx:id="deleteServerButton" prefWidth="60" text="Delete" />
                        </HBox>

                        <Separator />

                        <GridPane hgap="10" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints minWidth="100" prefWidth="120" />
                                <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                                <ColumnConstraints minWidth="80" prefWidth="100" />
                                <ColumnConstraints hgrow="ALWAYS" minWidth="100" prefWidth="150" />
                            </columnConstraints>

                            <!-- Row 0: Host and Port -->
                            <Label text="Host:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                            <TextField fx:id="hostField" promptText="192.168.1.100 or example.com" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                            <Label text="Port:" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                            <TextField fx:id="portField" prefWidth="80" text="22" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                            <!-- Row 1: Username -->
                            <Label text="Username:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                            <TextField fx:id="usernameField" promptText="Enter SSH username" GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="1" />

                            <!-- Row 3: Password -->
                            <Label prefHeight="35.0" prefWidth="55.0" text="Password:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                            <PasswordField fx:id="passwordField" promptText="Enter password" GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="2" />
                     <rowConstraints>
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints maxHeight="0.0" minHeight="0.0" prefHeight="0.0" />
                        <RowConstraints maxHeight="0.0" minHeight="0.0" prefHeight="0.0" />
                        <RowConstraints maxHeight="0.0" minHeight="0.0" prefHeight="0.0" />
                     </rowConstraints>
                        </GridPane>

                        <HBox alignment="CENTER_RIGHT" spacing="10">
                            <CheckBox fx:id="savePasswordCheckBox" text="Save password" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button fx:id="connectButton" prefWidth="100" text="Connect" />
                            <Button fx:id="disconnectButton" prefWidth="100" text="Disconnect" />
                        </HBox>
                    </VBox>

                    <!-- Remote File Browser -->
                    <VBox fx:id="remoteBrowserPane" spacing="10" VBox.vgrow="ALWAYS">

                        <Label text="Remote File Browser" />

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Path:" />
                            <TextField fx:id="remotePathField" promptText="/var/log" HBox.hgrow="ALWAYS" />
                            <Button fx:id="goButton" prefWidth="60" text="Go" />
                            <Button fx:id="parentDirButton" prefWidth="80" text="â†‘ Parent" />
                        </HBox>

                        <TableView fx:id="remoteFilesTable" minHeight="200" prefHeight="250" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="fileNameColumn" prefWidth="400" text="Name" />
                                <TableColumn fx:id="fileTypeColumn" prefWidth="120" text="Type" />
                                <TableColumn fx:id="fileSizeColumn" prefWidth="150" text="Size" />
                            </columns>
                            <placeholder>
                                <Label text="Connect to SSH server to browse files" />
                            </placeholder>
                        </TableView>

                        <Label text="Double-click on a directory to navigate, select a file and click OK to open" />
                    </VBox>
                </VBox>
            </Tab>
        </TabPane>
    </center>

    <!-- Bottom: Action Buttons -->
    <bottom>
        <HBox alignment="CENTER_RIGHT" spacing="10">
            <padding>
                <Insets bottom="10" left="15" right="15" top="10" />
            </padding>

            <Button fx:id="okButton" defaultButton="true" prefWidth="80" text="OK" />
            <Button fx:id="cancelButton" cancelButton="true" prefWidth="80" text="Cancel" />
        </HBox>
    </bottom>

</BorderPane>
